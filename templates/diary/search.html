{% extends "base.html" %}
{% block content %}

{% if user.is_authenticated %}

    <p>회원번호, {{ user.id }} !</p>
    <p>안녕하세요, {{ user.nickname }} 님!</p>
    <p>이메일: {{ user.email }}</p>
    <a href="{% url 'users:logout' %}">로그아웃</a>
    <div class="input-group">
        <input type="text" id="search_kw" class="form-control" value="{{ kw|default_if_none:'' }}">
        <div class="input-group-append">
            <button class="btn btn-outline-secondary" type="button" id="btn_search">찾기</button>
        </div>
    </div>
    <form id="searchForm" method="get" action="{% url 'diary:search' %}">
        <input type="hidden" id="kw" name="kw" value="{{ kw|default_if_none:'' }}">
    </form>


    <form method="POST" enctype="multipart/form-data">
    <p>음식 조회</p>
    <p>사진으로 조회는 따로 추가해야함</p>
        <a href="/diary/photo/">사진조회</a>
    <img src="{{ photo.photo_url.url }}">

    {% if food_list %}
    <ul>
    {% for food in food_list %}
        <li><a href="/diary/meal/{{ food.food_id }}/?photo_id={{ photo.photo_id }}">{{ food.food_name }}</a></li>
    {% endfor %}
    </ul>

{% else %}
    <p>조회된 음식이 없습니다.</p>
{% endif %}
    </form>


{% else %}
    <p>로그인이 필요합니다.</p>
{% endif %}


<script type='text/javascript'>
    document.addEventListener('DOMContentLoaded', function() {
        const btn_search = document.getElementById("btn_search");
        btn_search.addEventListener('click', function() {
            console.log('버튼이 클릭되었습니다.');
            console.log(document.getElementById('search_kw').value);
            document.getElementById('kw').value = document.getElementById('search_kw').value;
            console.log(document.getElementById('kw').value);
            document.getElementById('searchForm').submit();
        });
    });
</script>


{% endblock %}