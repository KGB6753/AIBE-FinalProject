{% extends "base.html" %}
{% block content %}

{% if user.is_authenticated %}
    <p>회원번호, {{ user.id }} !</p>
    <p>안녕하세요, {{ user.nickname }} 님!</p>
    <p>이메일: {{ user.email }}</p>
    <a href="{% url 'users:logout' %}">로그아웃</a>
    <p>식사 입력!!</p>
{% if food %}
    <h1>{{ food.food_name }}</h1>
    <h2>{{ food.food_weight }}g</h2>
    <h2>{{ food.food_kcal }}kcal</h2>
    <h2>{{ food.food_carbs }}kcal</h2>
    <h2>{{ food.food_proteins }}kcal</h2>
    <h2>{{ food.food_fats }}kcal</h2>

    <img src="{{ photo.photo_url.url }}">
    <h2>Create Menu</h2>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
<!--        {{ form.as_p }}-->
        {{ form.menu_category }}
        무게(인분)<input type="number" name="menu_weight" step="0.1">
        <input type="datetime-local" name="menu_date" id="menu_date">
        <input type="hidden" name="menu_food_id" value="{{ food.food_id }}">
        <input type="hidden" name="menu_photo_id" value="{{ photo.photo_id }}">

        <button type="submit">Save Menu</button>
    </form>

{% else %}
    <p>조회된 음식이 없습니다.</p>
{% endif %}
{% else %}
    <p>로그인이 필요합니다.</p>
{% endif %}
<script>
    // 현재 시간을 가져오는 함수
    function getCurrentDateTime() {
        const now = new Date();
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, '0');
        const day = now.getDate().toString().padStart(2, '0');
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');

        return `${year}-${month}-${day}T${hours}:${minutes}`;
    }

    // 현재 시간을 input 요소에 설정
    document.getElementById('menu_date').value = getCurrentDateTime();
</script>


{% endblock %}